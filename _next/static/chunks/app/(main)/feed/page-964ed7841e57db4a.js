(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[945],{9902:function(e,t,a){Promise.resolve().then(a.bind(a,3257))},3257:function(e,t,a){"use strict";a.d(t,{FeedClient:function(){return o}});var n=a(7437),s=a(7648);let r=(0,a(9205).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var i=a(2265),c=a(5082),l=a(3448);function u(e){let{post:t,className:a}=e;return(0,n.jsxs)(s.default,{href:"/detail?id=".concat(encodeURIComponent(t.id)),className:(0,l.cn)("block overflow-hidden rounded-xl bg-white shadow-sm transition active:scale-[0.98]",a),children:[(0,n.jsxs)("div",{className:"relative aspect-[4/3] w-full bg-gray-100",children:[(0,n.jsx)("img",{src:t.imageData,alt:t.menuName,className:"h-full w-full object-cover"}),(0,n.jsx)("span",{className:"absolute bottom-2 right-2 rounded bg-black/50 px-2 py-0.5 text-xs text-white",children:"best"===t.rating?"\uD83E\uDD2F":"\uD83D\uDE0B"})]}),(0,n.jsxs)("div",{className:"p-3",children:[(0,n.jsx)("p",{className:"font-medium text-gray-900 line-clamp-1",children:t.menuName}),t.placeName&&(0,n.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["\uD83D\uDCCD ",t.placeName]})]})]})}function d(){return(0,n.jsx)("div",{className:"grid grid-cols-2 gap-3 p-4 sm:grid-cols-3",children:[1,2,3,4,5,6].map(e=>(0,n.jsxs)("div",{className:"overflow-hidden rounded-xl bg-white shadow-sm",children:[(0,n.jsx)("div",{className:"aspect-[4/3] w-full animate-pulse bg-gray-200"}),(0,n.jsxs)("div",{className:"space-y-2 p-3",children:[(0,n.jsx)("div",{className:"h-4 w-3/4 animate-pulse rounded bg-gray-200"}),(0,n.jsx)("div",{className:"h-3 w-1/2 animate-pulse rounded bg-gray-100"})]})]},e))})}function o(){let[e,t]=(0,i.useState)([]),[a,l]=(0,i.useState)(!0),[o,m]=(0,i.useState)("all"),p=async e=>{l(!0),t("all"===e?await (0,c.Bd)():await (0,c.ud)()),l(!1)};(0,i.useEffect)(()=>{p("all")},[]);let E=e=>{e!==o&&(m(e),p(e))};return a?(0,n.jsx)(d,{}):0===e.length?(0,n.jsxs)("div",{className:"px-4 py-16 text-center",children:[(0,n.jsxs)("div",{className:"mb-4 flex items-center justify-center gap-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>E("all"),className:"min-w-[80px] rounded-full px-4 py-1 text-sm font-medium ".concat("all"===o?"bg-primary text-white":"bg-gray-100 text-gray-600"),children:"전체"}),(0,n.jsx)("button",{type:"button",onClick:()=>E("saved"),className:"min-w-[80px] rounded-full px-4 py-1 text-sm font-medium ".concat("saved"===o?"bg-primary text-white":"bg-gray-100 text-gray-600"),children:"저장한 것만"})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,n.jsx)("p",{className:"text-gray-500",children:"all"===o?"아직 올라온 맛이 없어요.":"저장한 맛이 없어요."}),(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"all"===o?"첫 맛을 올려보세요!":"마음에 드는 맛을 저장해보세요!"})]}),(0,n.jsx)("div",{className:"mt-8 flex justify-center",children:(0,n.jsxs)(s.default,{href:"/upload",className:"inline-flex items-center gap-2 rounded-full bg-primary px-5 py-2 text-sm font-medium text-white active:scale-95",children:[(0,n.jsx)(r,{className:"h-4 w-4"}),"맛 올리기"]})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2 px-4 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:()=>E("all"),className:"min-w-[80px] rounded-full px-4 py-1 text-sm font-medium ".concat("all"===o?"bg-primary text-white":"bg-gray-100 text-gray-600"),children:"전체"}),(0,n.jsx)("button",{type:"button",onClick:()=>E("saved"),className:"min-w-[80px] rounded-full px-4 py-1 text-sm font-medium ".concat("saved"===o?"bg-primary text-white":"bg-gray-100 text-gray-600"),children:"저장한 것만"})]}),(0,n.jsxs)(s.default,{href:"/upload",className:"fixed bottom-6 right-4 z-40 inline-flex h-12 items-center gap-2 rounded-full bg-primary px-4 text-sm font-medium text-white shadow-lg active:scale-95",children:[(0,n.jsx)(r,{className:"h-5 w-5"}),"올리기"]}),(0,n.jsx)("div",{className:"p-4",style:{columnCount:2,columnGap:"12px"},children:e.map(e=>(0,n.jsx)("div",{className:"mb-3 break-inside-avoid",style:{display:"inline-block",width:"100%"},children:(0,n.jsx)(u,{post:e})},e.id))})]})}},181:function(e,t,a){"use strict";a.d(t,{zA:function(){return l},rt:function(){return d},mX:function(){return u}});let n="nyam-db",s="sqlite",r="local-user",i=null;async function c(){return(0,(await Promise.all([a.e(218),a.e(17),a.e(803)]).then(a.t.bind(a,919,23))).default)({locateFile:e=>"/".concat(e)})}async function l(){if(i)return i;let e=await c(),t=await new Promise((e,t)=>{let a=indexedDB.open(n,1);a.onerror=()=>t(a.error),a.onsuccess=()=>{let n=a.result;if(!n.objectStoreNames.contains(s)){n.close(),e(null);return}let r=n.transaction(s,"readonly"),i=r.objectStore(s).get("db");i.onerror=()=>t(i.error),i.onsuccess=()=>{var t;return e(null!==(t=i.result)&&void 0!==t?t:null)},r.oncomplete=()=>n.close()},a.onupgradeneeded=e=>{e.target.result.createObjectStore(s)}});return t&&t.length>0?i=new e.Database(t):(function(e){e.run("\nCREATE TABLE IF NOT EXISTS users (\n  id TEXT PRIMARY KEY,\n  name TEXT,\n  createdAt TEXT NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS posts (\n  id TEXT PRIMARY KEY,\n  userId TEXT NOT NULL,\n  menuName TEXT NOT NULL,\n  tasteReview TEXT NOT NULL,\n  rating TEXT NOT NULL CHECK (rating IN ('good', 'best')),\n  lat REAL,\n  lng REAL,\n  city TEXT,\n  imageData TEXT NOT NULL,\n  createdAt TEXT NOT NULL,\n  FOREIGN KEY (userId) REFERENCES users(id)\n);\n\nCREATE TABLE IF NOT EXISTS saved_posts (\n  userId TEXT NOT NULL,\n  postId TEXT NOT NULL,\n  createdAt TEXT NOT NULL,\n  PRIMARY KEY (userId, postId),\n  FOREIGN KEY (userId) REFERENCES users(id),\n  FOREIGN KEY (postId) REFERENCES posts(id)\n);\n\nCREATE INDEX IF NOT EXISTS idx_posts_createdAt ON posts(createdAt DESC);\nCREATE INDEX IF NOT EXISTS idx_saved_posts_userId ON saved_posts(userId);\n");try{e.run("INSERT INTO users (id, name, createdAt) VALUES (?, ?, ?)",[r,null,new Date().toISOString()])}catch(e){}}(i=new e.Database),await u()),i}async function u(){if(!i)return;let e=i.export();await new Promise((t,a)=>{let r=indexedDB.open(n,1);r.onerror=()=>a(r.error),r.onsuccess=()=>{let n=r.result,i=n.transaction(s,"readwrite");i.objectStore(s).put(e,"db"),i.onerror=()=>a(i.error),i.oncomplete=()=>{n.close(),t()}},r.onupgradeneeded=e=>{e.target.result.createObjectStore(s)}})}function d(){return r}},5082:function(e,t,a){"use strict";a.d(t,{Bd:function(){return r},HW:function(){return m},SF:function(){return c},u_:function(){return i},ud:function(){return p},xX:function(){return l}});var n=a(181);function s(e){var t;return{id:e[0],userId:e[1],menuName:e[2],tasteReview:e[3],rating:e[4],placeName:null!==(t=e[5])&&void 0!==t?t:null,imageData:e[6],createdAt:e[7]}}async function r(){let e=(await (0,n.zA)()).exec("SELECT id, userId, menuName, tasteReview, rating, city as placeName, imageData, createdAt FROM posts ORDER BY createdAt DESC");return e.length?e[0].values.map(e=>s(e)):[]}async function i(e){let t=(await (0,n.zA)()).prepare("SELECT id, userId, menuName, tasteReview, rating, city as placeName, imageData, createdAt FROM posts WHERE id = ?");t.bind([e]);let a=t.step()?t.get():null;return t.free(),a?s(a):null}async function c(e){let t=await (0,n.zA)(),a=(0,n.rt)(),s="post-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,9)),r=new Date().toISOString();return t.run("INSERT INTO posts (id, userId, menuName, tasteReview, rating, city, imageData, createdAt)\n     VALUES (?, ?, ?, ?, ?, ?, ?, ?)",[s,a,e.menuName,e.tasteReview,e.rating,e.imageData,r]),await (0,n.mX)(),{id:s,userId:a,...e,createdAt:r}}async function l(e){let t=(await (0,n.zA)()).prepare("SELECT postId FROM saved_posts WHERE userId = ?");t.bind([e]);let a=[];for(;t.step();)a.push(t.get()[0]);return t.free(),new Set(a)}async function u(e,t){let a=(await (0,n.zA)()).prepare("SELECT 1 FROM saved_posts WHERE userId = ? AND postId = ?");a.bind([e,t]);let s=a.step();return a.free(),s}async function d(e){let t=await (0,n.zA)(),a=(0,n.rt)(),s=new Date().toISOString();try{t.run("INSERT INTO saved_posts (userId, postId, createdAt) VALUES (?, ?, ?)",[a,e,s]),await (0,n.mX)()}catch(e){}}async function o(e){let t=await (0,n.zA)(),a=(0,n.rt)();t.run("DELETE FROM saved_posts WHERE userId = ? AND postId = ?",[a,e]),await (0,n.mX)()}async function m(e){let t=(0,n.rt)();return await u(t,e)?(await o(e),!1):(await d(e),!0)}async function p(){let e=await (0,n.zA)(),t=(0,n.rt)(),a=e.prepare("SELECT p.id, p.userId, p.menuName, p.tasteReview, p.rating, p.city as placeName, p.imageData, p.createdAt\n     FROM posts p\n     INNER JOIN saved_posts s ON p.id = s.postId\n     WHERE s.userId = ?\n     ORDER BY s.createdAt DESC");a.bind([t]);let r=[];for(;a.step();)r.push(s(a.get()));return a.free(),r}},3448:function(e,t,a){"use strict";a.d(t,{cn:function(){return r}});var n=a(1994),s=a(3335);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,n.W)(t))}}},function(e){e.O(0,[590,648,971,117,744],function(){return e(e.s=9902)}),_N_E=e.O()}]);