(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55],{5288:function(e,t,n){Promise.resolve().then(n.bind(n,6481))},6481:function(e,t,n){"use strict";n.d(t,{SavedClient:function(){return u}});var a=n(7437),r=n(2265),s=n(5082),i=n(2471),c=n(427);function u(){let[e,t]=(0,r.useState)([]),[n,u]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(0,s.ud)().then(e=>{t(e),u(!1)})},[]),n)?(0,a.jsx)(c.p,{}):0===e.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 px-4 py-16 text-center",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"저장한 맛이 없어요."}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"피드에서 마음에 드는 맛을 저장해보세요!"})]}):(0,a.jsx)("div",{className:"p-4",style:{columnCount:2,columnGap:"12px"},children:e.map(e=>(0,a.jsx)("div",{className:"mb-3 break-inside-avoid",style:{display:"inline-block",width:"100%"},children:(0,a.jsx)(i.B,{post:e})},e.id))})}},2471:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var a=n(7437),r=n(7648),s=n(3448);function i(e){let{post:t,className:n}=e;return(0,a.jsxs)(r.default,{href:"/detail?id=".concat(encodeURIComponent(t.id)),className:(0,s.cn)("block overflow-hidden rounded-xl bg-white shadow-sm transition active:scale-[0.98]",n),children:[(0,a.jsxs)("div",{className:"relative aspect-[4/3] w-full bg-gray-100",children:[(0,a.jsx)("img",{src:t.imageData,alt:t.menuName,className:"h-full w-full object-cover"}),(0,a.jsx)("span",{className:"absolute bottom-2 right-2 rounded bg-black/50 px-2 py-0.5 text-xs text-white",children:"best"===t.rating?"\uD83E\uDD2F":"\uD83D\uDE0B"})]}),(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 line-clamp-1",children:t.menuName}),t.placeName&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["\uD83D\uDCCD ",t.placeName]})]})]})}},427:function(e,t,n){"use strict";n.d(t,{p:function(){return r}});var a=n(7437);function r(){return(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3 p-4 sm:grid-cols-3",children:[1,2,3,4,5,6].map(e=>(0,a.jsxs)("div",{className:"overflow-hidden rounded-xl bg-white shadow-sm",children:[(0,a.jsx)("div",{className:"aspect-[4/3] w-full animate-pulse bg-gray-200"}),(0,a.jsxs)("div",{className:"space-y-2 p-3",children:[(0,a.jsx)("div",{className:"h-4 w-3/4 animate-pulse rounded bg-gray-200"}),(0,a.jsx)("div",{className:"h-3 w-1/2 animate-pulse rounded bg-gray-100"})]})]},e))})}},181:function(e,t,n){"use strict";n.d(t,{zA:function(){return u},rt:function(){return d},mX:function(){return o}});let a="nyam-db",r="sqlite",s="local-user",i=null;async function c(){return(0,(await Promise.all([n.e(218),n.e(17),n.e(803)]).then(n.t.bind(n,919,23))).default)({locateFile:e=>"/".concat(e)})}async function u(){if(i)return i;let e=await c(),t=await new Promise((e,t)=>{let n=indexedDB.open(a,1);n.onerror=()=>t(n.error),n.onsuccess=()=>{let a=n.result;if(!a.objectStoreNames.contains(r)){a.close(),e(null);return}let s=a.transaction(r,"readonly"),i=s.objectStore(r).get("db");i.onerror=()=>t(i.error),i.onsuccess=()=>{var t;return e(null!==(t=i.result)&&void 0!==t?t:null)},s.oncomplete=()=>a.close()},n.onupgradeneeded=e=>{e.target.result.createObjectStore(r)}});return t&&t.length>0?i=new e.Database(t):(function(e){e.run("\nCREATE TABLE IF NOT EXISTS users (\n  id TEXT PRIMARY KEY,\n  name TEXT,\n  createdAt TEXT NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS posts (\n  id TEXT PRIMARY KEY,\n  userId TEXT NOT NULL,\n  menuName TEXT NOT NULL,\n  tasteReview TEXT NOT NULL,\n  rating TEXT NOT NULL CHECK (rating IN ('good', 'best')),\n  lat REAL,\n  lng REAL,\n  city TEXT,\n  imageData TEXT NOT NULL,\n  createdAt TEXT NOT NULL,\n  FOREIGN KEY (userId) REFERENCES users(id)\n);\n\nCREATE TABLE IF NOT EXISTS saved_posts (\n  userId TEXT NOT NULL,\n  postId TEXT NOT NULL,\n  createdAt TEXT NOT NULL,\n  PRIMARY KEY (userId, postId),\n  FOREIGN KEY (userId) REFERENCES users(id),\n  FOREIGN KEY (postId) REFERENCES posts(id)\n);\n\nCREATE INDEX IF NOT EXISTS idx_posts_createdAt ON posts(createdAt DESC);\nCREATE INDEX IF NOT EXISTS idx_saved_posts_userId ON saved_posts(userId);\n");try{e.run("INSERT INTO users (id, name, createdAt) VALUES (?, ?, ?)",[s,null,new Date().toISOString()])}catch(e){}}(i=new e.Database),await o()),i}async function o(){if(!i)return;let e=i.export();await new Promise((t,n)=>{let s=indexedDB.open(a,1);s.onerror=()=>n(s.error),s.onsuccess=()=>{let a=s.result,i=a.transaction(r,"readwrite");i.objectStore(r).put(e,"db"),i.onerror=()=>n(i.error),i.oncomplete=()=>{a.close(),t()}},s.onupgradeneeded=e=>{e.target.result.createObjectStore(r)}})}function d(){return s}},5082:function(e,t,n){"use strict";n.d(t,{Bd:function(){return s},HW:function(){return p},SF:function(){return c},qp:function(){return E},u_:function(){return i},ud:function(){return m},xX:function(){return u}});var a=n(181);function r(e){var t;return{id:e[0],userId:e[1],menuName:e[2],tasteReview:e[3],rating:e[4],placeName:null!==(t=e[5])&&void 0!==t?t:null,imageData:e[6],createdAt:e[7]}}async function s(){let e=(await (0,a.zA)()).exec("SELECT id, userId, menuName, tasteReview, rating, city as placeName, imageData, createdAt FROM posts ORDER BY createdAt DESC");return e.length?e[0].values.map(e=>r(e)):[]}async function i(e){let t=(await (0,a.zA)()).prepare("SELECT id, userId, menuName, tasteReview, rating, city as placeName, imageData, createdAt FROM posts WHERE id = ?");t.bind([e]);let n=t.step()?t.get():null;return t.free(),n?r(n):null}async function c(e){let t=await (0,a.zA)(),n=(0,a.rt)(),r="post-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,9)),s=new Date().toISOString();return t.run("INSERT INTO posts (id, userId, menuName, tasteReview, rating, city, imageData, createdAt)\n     VALUES (?, ?, ?, ?, ?, ?, ?, ?)",[r,n,e.menuName,e.tasteReview,e.rating,e.imageData,s]),await (0,a.mX)(),{id:r,userId:n,...e,createdAt:s}}async function u(e){let t=(await (0,a.zA)()).prepare("SELECT postId FROM saved_posts WHERE userId = ?");t.bind([e]);let n=[];for(;t.step();)n.push(t.get()[0]);return t.free(),new Set(n)}async function o(e,t){let n=(await (0,a.zA)()).prepare("SELECT 1 FROM saved_posts WHERE userId = ? AND postId = ?");n.bind([e,t]);let r=n.step();return n.free(),r}async function d(e){let t=await (0,a.zA)(),n=(0,a.rt)(),r=new Date().toISOString();try{t.run("INSERT INTO saved_posts (userId, postId, createdAt) VALUES (?, ?, ?)",[n,e,r]),await (0,a.mX)()}catch(e){}}async function l(e){let t=await (0,a.zA)(),n=(0,a.rt)();t.run("DELETE FROM saved_posts WHERE userId = ? AND postId = ?",[n,e]),await (0,a.mX)()}async function p(e){let t=(0,a.rt)();return await o(t,e)?(await l(e),!1):(await d(e),!0)}async function E(){let e=await (0,a.zA)(),t=(0,a.rt)(),n=e.prepare("SELECT id, userId, menuName, tasteReview, rating, city as placeName, imageData, createdAt FROM posts WHERE userId = ? ORDER BY createdAt DESC");n.bind([t]);let s=[];for(;n.step();)s.push(r(n.get()));return n.free(),s}async function m(){let e=await (0,a.zA)(),t=(0,a.rt)(),n=e.prepare("SELECT p.id, p.userId, p.menuName, p.tasteReview, p.rating, p.city as placeName, p.imageData, p.createdAt\n     FROM posts p\n     INNER JOIN saved_posts s ON p.id = s.postId\n     WHERE s.userId = ?\n     ORDER BY s.createdAt DESC");n.bind([t]);let s=[];for(;n.step();)s.push(r(n.get()));return n.free(),s}},3448:function(e,t,n){"use strict";n.d(t,{cn:function(){return s}});var a=n(1994),r=n(3335);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[137,648,971,117,744],function(){return e(e.s=5288)}),_N_E=e.O()}]);