(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[654],{8320:function(e,t,n){Promise.resolve().then(n.bind(n,8705))},2660:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9376:function(e,t,n){"use strict";var a=n(5475);n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})},8705:function(e,t,n){"use strict";n.d(t,{default:function(){return d}});var a=n(7437),r=n(9376),s=n(2265),c=n(2660);let i=(0,n(9205).Z)("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);var u=n(5082),o=n(181),l=n(3448);function d(){let e=(0,r.useRouter)(),t=(0,r.useSearchParams)().get("id"),[n,d]=(0,s.useState)(null),[m,E]=(0,s.useState)(!1),[p,N]=(0,s.useState)(!0);(0,s.useEffect)(()=>{if(!t){N(!1);return}let e=!1;return(0,u.u_)(t).then(t=>{e||d(t),N(!1)}),()=>{e=!0}},[t]),(0,s.useEffect)(()=>{t&&(0,u.xX)((0,o.rt)()).then(e=>E(e.has(t)))},[t]);let f=async()=>{t&&E(await (0,u.HW)(t))};return p?(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)("header",{className:"flex min-h-[44px] items-center border-b border-gray-200 px-4 py-2"}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("p",{className:"text-gray-500",children:"로딩 중..."})})]}):n?(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsxs)("header",{className:"sticky top-0 z-10 flex min-h-[44px] items-center justify-between border-b border-gray-200 bg-white px-4 py-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>e.back(),className:"touch-target flex items-center justify-center rounded-lg text-gray-600 active:scale-95","aria-label":"닫기",children:(0,a.jsx)(c.Z,{className:"h-6 w-6"})}),(0,a.jsxs)("button",{type:"button",onClick:f,className:(0,l.cn)("touch-target flex items-center gap-1 rounded-lg px-2 py-1 text-sm font-medium active:scale-95",m?"text-primary":"text-gray-600"),"aria-label":m?"저장 취소":"저장",children:[(0,a.jsx)(i,{className:(0,l.cn)("h-5 w-5",m&&"fill-current")}),m?"저장됨":"저장"]})]}),(0,a.jsxs)("div",{className:"pb-8",children:[(0,a.jsx)("div",{className:"relative aspect-[4/3] w-full bg-gray-100",children:(0,a.jsx)("img",{src:n.imageData,alt:n.menuName,className:"h-full w-full object-cover"})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:n.menuName}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:n.tasteReview}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"best"===n.rating?"\uD83E\uDD2F Best":"\uD83D\uDE0B Good"}),n.placeName&&(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:["\uD83D\uDCCD ",n.placeName]})]})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)("header",{className:"flex min-h-[44px] items-center border-b border-gray-200 px-4 py-2",children:(0,a.jsx)("button",{type:"button",onClick:()=>e.back(),className:"touch-target flex items-center justify-center rounded-lg text-gray-600 active:scale-95","aria-label":"닫기",children:(0,a.jsx)(c.Z,{className:"h-6 w-6"})})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("p",{className:"text-gray-500",children:"게시글을 찾을 수 없어요."})})]})}},181:function(e,t,n){"use strict";n.d(t,{zA:function(){return u},rt:function(){return l},mX:function(){return o}});let a="nyam-db",r="sqlite",s="local-user",c=null;async function i(){return(0,(await Promise.all([n.e(218),n.e(17),n.e(803)]).then(n.t.bind(n,919,23))).default)({locateFile:e=>"/".concat(e)})}async function u(){if(c)return c;let e=await i(),t=await new Promise((e,t)=>{let n=indexedDB.open(a,1);n.onerror=()=>t(n.error),n.onsuccess=()=>{let a=n.result;if(!a.objectStoreNames.contains(r)){a.close(),e(null);return}let s=a.transaction(r,"readonly"),c=s.objectStore(r).get("db");c.onerror=()=>t(c.error),c.onsuccess=()=>{var t;return e(null!==(t=c.result)&&void 0!==t?t:null)},s.oncomplete=()=>a.close()},n.onupgradeneeded=e=>{e.target.result.createObjectStore(r)}});return t&&t.length>0?c=new e.Database(t):(function(e){e.run("\nCREATE TABLE IF NOT EXISTS users (\n  id TEXT PRIMARY KEY,\n  name TEXT,\n  createdAt TEXT NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS posts (\n  id TEXT PRIMARY KEY,\n  userId TEXT NOT NULL,\n  menuName TEXT NOT NULL,\n  tasteReview TEXT NOT NULL,\n  rating TEXT NOT NULL CHECK (rating IN ('good', 'best')),\n  lat REAL,\n  lng REAL,\n  city TEXT,\n  imageData TEXT NOT NULL,\n  createdAt TEXT NOT NULL,\n  FOREIGN KEY (userId) REFERENCES users(id)\n);\n\nCREATE TABLE IF NOT EXISTS saved_posts (\n  userId TEXT NOT NULL,\n  postId TEXT NOT NULL,\n  createdAt TEXT NOT NULL,\n  PRIMARY KEY (userId, postId),\n  FOREIGN KEY (userId) REFERENCES users(id),\n  FOREIGN KEY (postId) REFERENCES posts(id)\n);\n\nCREATE INDEX IF NOT EXISTS idx_posts_createdAt ON posts(createdAt DESC);\nCREATE INDEX IF NOT EXISTS idx_saved_posts_userId ON saved_posts(userId);\n");try{e.run("INSERT INTO users (id, name, createdAt) VALUES (?, ?, ?)",[s,null,new Date().toISOString()])}catch(e){}}(c=new e.Database),await o()),c}async function o(){if(!c)return;let e=c.export();await new Promise((t,n)=>{let s=indexedDB.open(a,1);s.onerror=()=>n(s.error),s.onsuccess=()=>{let a=s.result,c=a.transaction(r,"readwrite");c.objectStore(r).put(e,"db"),c.onerror=()=>n(c.error),c.oncomplete=()=>{a.close(),t()}},s.onupgradeneeded=e=>{e.target.result.createObjectStore(r)}})}function l(){return s}},5082:function(e,t,n){"use strict";n.d(t,{Bd:function(){return s},HW:function(){return m},SF:function(){return i},u_:function(){return c},ud:function(){return E},xX:function(){return u}});var a=n(181);function r(e){var t;return{id:e[0],userId:e[1],menuName:e[2],tasteReview:e[3],rating:e[4],placeName:null!==(t=e[5])&&void 0!==t?t:null,imageData:e[6],createdAt:e[7]}}async function s(){let e=(await (0,a.zA)()).exec("SELECT id, userId, menuName, tasteReview, rating, city as placeName, imageData, createdAt FROM posts ORDER BY createdAt DESC");return e.length?e[0].values.map(e=>r(e)):[]}async function c(e){let t=(await (0,a.zA)()).prepare("SELECT id, userId, menuName, tasteReview, rating, city as placeName, imageData, createdAt FROM posts WHERE id = ?");t.bind([e]);let n=t.step()?t.get():null;return t.free(),n?r(n):null}async function i(e){let t=await (0,a.zA)(),n=(0,a.rt)(),r="post-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,9)),s=new Date().toISOString();return t.run("INSERT INTO posts (id, userId, menuName, tasteReview, rating, city, imageData, createdAt)\n     VALUES (?, ?, ?, ?, ?, ?, ?, ?)",[r,n,e.menuName,e.tasteReview,e.rating,e.imageData,s]),await (0,a.mX)(),{id:r,userId:n,...e,createdAt:s}}async function u(e){let t=(await (0,a.zA)()).prepare("SELECT postId FROM saved_posts WHERE userId = ?");t.bind([e]);let n=[];for(;t.step();)n.push(t.get()[0]);return t.free(),new Set(n)}async function o(e,t){let n=(await (0,a.zA)()).prepare("SELECT 1 FROM saved_posts WHERE userId = ? AND postId = ?");n.bind([e,t]);let r=n.step();return n.free(),r}async function l(e){let t=await (0,a.zA)(),n=(0,a.rt)(),r=new Date().toISOString();try{t.run("INSERT INTO saved_posts (userId, postId, createdAt) VALUES (?, ?, ?)",[n,e,r]),await (0,a.mX)()}catch(e){}}async function d(e){let t=await (0,a.zA)(),n=(0,a.rt)();t.run("DELETE FROM saved_posts WHERE userId = ? AND postId = ?",[n,e]),await (0,a.mX)()}async function m(e){let t=(0,a.rt)();return await o(t,e)?(await d(e),!1):(await l(e),!0)}async function E(){let e=await (0,a.zA)(),t=(0,a.rt)(),n=e.prepare("SELECT p.id, p.userId, p.menuName, p.tasteReview, p.rating, p.city as placeName, p.imageData, p.createdAt\n     FROM posts p\n     INNER JOIN saved_posts s ON p.id = s.postId\n     WHERE s.userId = ?\n     ORDER BY s.createdAt DESC");n.bind([t]);let s=[];for(;n.step();)s.push(r(n.get()));return n.free(),s}},3448:function(e,t,n){"use strict";n.d(t,{cn:function(){return s}});var a=n(1994),r=n(3335);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[590,971,117,744],function(){return e(e.s=8320)}),_N_E=e.O()}]);