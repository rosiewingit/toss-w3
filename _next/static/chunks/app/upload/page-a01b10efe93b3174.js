(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{8879:function(e,t,r){Promise.resolve().then(r.bind(r,7354))},8996:function(e){var t;t=function(){"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function t(t){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?e(Object(a),!0).forEach(function(e){var r,n;r=e,n=a[e],(r=i(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function r(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function i(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var n,o,s,l,c,u,h,d={exports:{}};"undefined"!=typeof window&&(o=(n=window).HTMLCanvasElement&&n.HTMLCanvasElement.prototype,l=(s=n.Blob&&function(){try{return new Blob,!0}catch(e){return!1}}())&&n.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),c=n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,u=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,h=(s||c)&&n.atob&&n.ArrayBuffer&&n.Uint8Array&&function(e){var t,r,a,i,n,o,h,d,f;if(!(t=e.match(u)))throw Error("invalid data URI");for(d=0,r=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),a=!!t[4],i=e.slice(t[0].length),h=new Uint8Array(o=new ArrayBuffer((n=a?atob(i):decodeURIComponent(i)).length));d<n.length;d+=1)h[d]=n.charCodeAt(d);return s?new Blob([l?h:o],{type:r}):((f=new c).append(o),f.getBlob(r))},n.HTMLCanvasElement&&!o.toBlob&&(o.mozGetAsFile?o.toBlob=function(e,t,r){var a=this;setTimeout(function(){r&&o.toDataURL&&h?e(h(a.toDataURL(t,r))):e(a.mozGetAsFile("blob",t))})}:o.toDataURL&&h&&(o.msToBlob?o.toBlob=function(e,t,r){var a=this;setTimeout(function(){(t&&"image/png"!==t||r)&&o.toDataURL&&h?e(h(a.toDataURL(t,r))):e(a.msToBlob(t))})}:o.toBlob=function(e,t,r){var a=this;setTimeout(function(){e(h(a.toDataURL(t,r)))})})),d.exports?d.exports=h:n.dataURLtoBlob=h);var f=d.exports,m={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},b="undefined"!=typeof window&&void 0!==window.document?window:{},g=function(e){return e>0&&e<1/0},p=Array.prototype.slice;function v(e){return Array.from?Array.from(e):p.call(e)}var y=/^image\/.+$/;function x(e){return y.test(e)}var w=String.fromCharCode,j=b.btoa;function k(e,t){for(var r=[],a=new Uint8Array(e);a.length>0;)r.push(w.apply(null,v(a.subarray(0,8192)))),a=a.subarray(8192);return"data:".concat(t,";base64,").concat(j(r.join("")))}var B=/\.\d*(?:0|9){12}\d*$/;function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return B.test(e)?Math.round(e*t)/t:e}function U(e){var t=e.aspectRatio,r=e.height,a=e.width,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",n=g(a),o=g(r);if(n&&o){var s=r*t;("contain"===i||"none"===i)&&s>a||"cover"===i&&s<a?r=a/t:a=r*t}else n?r=a/t:o&&(a=r*t);return{width:a,height:r}}var O=b.ArrayBuffer,N=b.FileReader,E=b.URL||b.webkitURL,D=/\.\w+$/,A=b.Compressor;return function(){var e,i;function n(e,r){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,n),this.file=e,this.exif=[],this.image=new Image,this.options=t(t({},m),r),this.aborted=!1,this.result=null,this.init()}return e=[{key:"init",value:function(){var e=this,t=this.file,r=this.options;if(!("undefined"!=typeof Blob&&(t instanceof Blob||"[object Blob]"===Object.prototype.toString.call(t)))){this.fail(Error("The first argument must be a File or Blob object."));return}var i=t.type;if(!x(i)){this.fail(Error("The first argument must be an image File or Blob object."));return}if(!E||!N){this.fail(Error("The current browser does not support image compression."));return}O||(r.checkOrientation=!1,r.retainExif=!1);var n="image/jpeg"===i,o=n&&r.checkOrientation,s=n&&r.retainExif;if(!E||o||s){var l=new N;this.reader=l,l.onload=function(r){var n=r.target.result,l={},c=1;o&&(c=function(e){var t=new DataView(e);try{if(255===t.getUint8(0)&&216===t.getUint8(1))for(var r=t.byteLength,a=2;a+1<r;){if(255===t.getUint8(a)&&225===t.getUint8(a+1)){u=a;break}a+=1}if(u){var i=u+4,n=u+10;if("Exif"===function(e,t,r){var a,i="";for(r+=t,a=t;a<r;a+=1)i+=w(e.getUint8(a));return i}(t,i,4)){var o=t.getUint16(n);if(((c=18761===o)||19789===o)&&42===t.getUint16(n+2,c)){var s=t.getUint32(n+4,c);s>=8&&(h=n+s)}}}if(h){var l,c,u,h,d,f,m=t.getUint16(h,c);for(f=0;f<m;f+=1)if(d=h+12*f+2,274===t.getUint16(d,c)){d+=8,l=t.getUint16(d,c),t.setUint16(d,1,c);break}}}catch(e){l=1}return l}(n))>1&&a(l,function(e){var t=0,r=1,a=1;switch(e){case 2:r=-1;break;case 3:t=-180;break;case 4:a=-1;break;case 5:t=90,a=-1;break;case 6:t=90;break;case 7:t=90,r=-1;break;case 8:t=-90}return{rotate:t,scaleX:r,scaleY:a}}(c)),s&&(e.exif=function(e){for(var t=v(new Uint8Array(e)),r=t.length,a=[],i=0;i+3<r;){var n=t[i],o=t[i+1];if(255===n&&218===o)break;if(255===n&&216===o)i+=2;else{var s=256*t[i+2]+t[i+3],l=i+s+2,c=t.slice(i,l);a.push(c),i=l}}return a.reduce(function(e,t){return 255===t[0]&&225===t[1]?e.concat(t):e},[])}(n)),o||s?!E||c>1?l.url=k(n,i):l.url=E.createObjectURL(t):l.url=n,e.load(l)},l.onabort=function(){e.fail(Error("Aborted to read the image with FileReader."))},l.onerror=function(){e.fail(Error("Failed to read the image with FileReader."))},l.onloadend=function(){e.reader=null},o||s?l.readAsArrayBuffer(t):l.readAsDataURL(t)}else this.load({url:E.createObjectURL(t)})}},{key:"load",value:function(e){var r=this,a=this.file,i=this.image;i.onload=function(){r.draw(t(t({},e),{},{naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight}))},i.onabort=function(){r.fail(Error("Aborted to load the image."))},i.onerror=function(){r.fail(Error("Failed to load the image."))},b.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(b.navigator.userAgent)&&(i.crossOrigin="anonymous"),i.alt=a.name,i.src=e.url}},{key:"draw",value:function(e){var t=this,r=e.naturalWidth,a=e.naturalHeight,i=e.rotate,n=void 0===i?0:i,o=e.scaleX,s=e.scaleY,l=this.file,c=this.image,u=this.options,h=document.createElement("canvas"),d=h.getContext("2d"),m=Math.abs(n)%180==90,b=("contain"===u.resize||"cover"===u.resize)&&g(u.width)&&g(u.height),p=Math.max(u.maxWidth,0)||1/0,y=Math.max(u.maxHeight,0)||1/0,w=Math.max(u.minWidth,0)||0,j=Math.max(u.minHeight,0)||0,B=r/a,O=u.width,E=u.height;if(m){var D=[y,p];p=D[0],y=D[1];var A=[j,w];w=A[0],j=A[1];var P=[E,O];O=P[0],E=P[1]}b&&(B=O/E);var T=U({aspectRatio:B,width:p,height:y},"contain");p=T.width,y=T.height;var C=U({aspectRatio:B,width:w,height:j},"cover");if(w=C.width,j=C.height,b){var S=U({aspectRatio:B,width:O,height:E},u.resize);O=S.width,E=S.height}else{var L=U({aspectRatio:B,width:O,height:E}),M=L.width;O=void 0===M?r:M;var F=L.height;E=void 0===F?a:F}O=Math.floor(R(Math.min(Math.max(O,w),p))),E=Math.floor(R(Math.min(Math.max(E,j),y)));var W=-O/2,z=-E/2,H=O,I=E,_=[];if(b){var q=0,G=0,Z=r,$=a,K=U({aspectRatio:B,width:r,height:a},{contain:"cover",cover:"contain"}[u.resize]);Z=K.width,$=K.height,q=(r-Z)/2,G=(a-$)/2,_.push(q,G,Z,$)}if(_.push(W,z,H,I),m){var V=[E,O];O=V[0],E=V[1]}h.width=O,h.height=E,x(u.mimeType)||(u.mimeType=l.type);var X="transparent";l.size>u.convertSize&&u.convertTypes.indexOf(u.mimeType)>=0&&(u.mimeType="image/jpeg");var Y="image/jpeg"===u.mimeType;if(Y&&(X="#fff"),d.fillStyle=X,d.fillRect(0,0,O,E),u.beforeDraw&&u.beforeDraw.call(this,d,h),!this.aborted&&(d.save(),d.translate(O/2,E/2),d.rotate(n*Math.PI/180),d.scale(void 0===o?1:o,void 0===s?1:s),d.drawImage.apply(d,[c].concat(_)),d.restore(),u.drew&&u.drew.call(this,d,h),!this.aborted)){var J=function(e){if(!t.aborted){var i=function(e){return t.done({naturalWidth:r,naturalHeight:a,result:e})};if(e&&Y&&u.retainExif&&t.exif&&t.exif.length>0){var n=function(e){return i(f(k(function(e,t){var r=v(new Uint8Array(e));if(255!==r[2]||224!==r[3])return e;var a=256*r[4]+r[5];return new Uint8Array([255,216].concat(t,r.slice(4+a)))}(e,t.exif),u.mimeType)))};if(e.arrayBuffer)e.arrayBuffer().then(n).catch(function(){t.fail(Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var o=new N;t.reader=o,o.onload=function(e){n(e.target.result)},o.onabort=function(){t.fail(Error("Aborted to read the compressed image with FileReader."))},o.onerror=function(){t.fail(Error("Failed to read the compressed image with FileReader."))},o.onloadend=function(){t.reader=null},o.readAsArrayBuffer(e)}}else i(e)}};h.toBlob?h.toBlob(J,u.mimeType,u.quality):J(f(h.toDataURL(u.mimeType,u.quality)))}}},{key:"done",value:function(e){var t=e.naturalWidth,r=e.naturalHeight,a=e.result,i=this.file,n=this.image,o=this.options;if(E&&0===n.src.indexOf("blob:")&&E.revokeObjectURL(n.src),a){if(o.strict&&!o.retainExif&&a.size>i.size&&o.mimeType===i.type&&!(o.width>t||o.height>r||o.minWidth>t||o.minHeight>r||o.maxWidth<t||o.maxHeight<r))a=i;else{var s,l,c=new Date;a.lastModified=c.getTime(),a.lastModifiedDate=c,a.name=i.name,a.name&&a.type!==i.type&&(a.name=a.name.replace(D,("jpeg"===(l=x(s=a.type)?s.substr(6):"")&&(l="jpg"),".".concat(l))))}}else a=i;this.result=a,o.success&&o.success.call(this,a)}},{key:"fail",value:function(e){var t=this.options;if(t.error)t.error.call(this,e);else throw e}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],i=[{key:"noConflict",value:function(){return window.Compressor=A,n}},{key:"setDefaults",value:function(e){a(m,e)}}],e&&r(n.prototype,e),i&&r(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n}()},e.exports=t()},2660:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},7354:function(e,t,r){"use strict";let a;r.d(t,{UploadForm:function(){return x}});var i=r(7437),n=r(2265),o=r(7648),s=r(9376),l=r(2660);let c=e=>{let t;let r=new Set,a=(e,a)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=a?a:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,n={setState:a,getState:i,getInitialState:()=>o,subscribe:e=>(r.add(e),()=>r.delete(e))},o=t=e(a,i,n);return n},u=e=>e?c(e):c,h=e=>e,d=e=>{let t=u(e),r=e=>(function(e,t=h){let r=n.useSyncExternalStore(e.subscribe,n.useCallback(()=>t(e.getState()),[e,t]),n.useCallback(()=>t(e.getInitialState()),[e,t]));return n.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},f={imageDataUrl:null,menuName:"",tasteReview:"",rating:"good",placeName:"",isSubmitting:!1},m=(a=e=>({...f,setImage:t=>e({imageDataUrl:t}),setMenuName:t=>e({menuName:t}),setTasteReview:t=>e({tasteReview:t.slice(0,100)}),setRating:t=>e({rating:t}),setPlaceName:t=>e({placeName:t}),setSubmitting:t=>e({isSubmitting:t}),reset:()=>e(f)}))?d(a):d;function b(e){let{value:t,onChange:r,placeholder:a="맛에 대해 100자 안으로 적어주세요."}=e,n=t.length,o=Math.min(n/100*100,100),s=2*Math.PI*18;return(0,i.jsxs)("div",{className:"relative flex items-center gap-3",children:[(0,i.jsxs)("div",{className:"relative h-10 w-10 shrink-0",children:[(0,i.jsxs)("svg",{className:"h-10 w-10 -rotate-90",viewBox:"0 0 40 40",children:[(0,i.jsx)("circle",{cx:"20",cy:"20",r:"18",fill:"none",stroke:"#E5E7EB",strokeWidth:"3"}),(0,i.jsx)("circle",{cx:"20",cy:"20",r:"18",fill:"none",stroke:"#0064FF",strokeWidth:"3",strokeDasharray:s,strokeDashoffset:s-o/100*s,strokeLinecap:"round",className:"transition-all duration-150"})]}),(0,i.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium text-gray-600",children:n})]}),(0,i.jsx)("textarea",{value:t,onChange:e=>r(e.target.value),maxLength:100,placeholder:a,rows:3,className:"min-h-[44px] w-full resize-none rounded-xl border border-gray-200 bg-white px-4 py-3 text-base outline-none focus:border-primary focus:ring-2 focus:ring-primary/20"})]})}var g=r(8996),p=r.n(g),v=r(3448);let y=[{value:"good",label:"Good",emoji:"\uD83D\uDE0B"},{value:"best",label:"Best",emoji:"\uD83E\uDD2F"}];function x(){let e=(0,s.useRouter)(),t=(0,n.useRef)(null),{imageDataUrl:a,menuName:c,tasteReview:u,rating:h,placeName:d,isSubmitting:f,setImage:g,setMenuName:x,setTasteReview:w,setRating:j,setPlaceName:k,setSubmitting:B,reset:R}=m(),U=(0,n.useCallback)(async e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r&&r.type.startsWith("image/")){try{let e=await new Promise((e,t)=>{new(p())(r,{maxWidth:800,maxHeight:800,quality:.8,convertSize:0,success(t){e(t)},error(e){t(e)}})}),t=await new Promise((t,r)=>{let a=new FileReader;a.onload=()=>t(a.result),a.onerror=()=>r(a.error),a.readAsDataURL(e)});g(t)}catch(e){g(null)}e.target.value=""}},[g]),O=(0,n.useCallback)(async t=>{if(t.preventDefault(),a&&c.trim()&&u.trim()){B(!0);try{let{insertPost:t}=await r.e(232).then(r.bind(r,3232));await t({menuName:c.trim(),tasteReview:u.trim(),rating:h,placeName:d.trim()||null,imageData:a}),R(),e.push("/feed")}finally{B(!1)}}},[a,c,u,h,d,R,e,B]);return(0,i.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,i.jsxs)("header",{className:"flex min-h-[44px] items-center gap-2 border-b border-gray-200 px-4 py-2",children:[(0,i.jsx)(o.default,{href:"/feed",className:"touch-target flex items-center justify-center rounded-lg text-gray-600 active:scale-95","aria-label":"닫기",children:(0,i.jsx)(l.Z,{className:"h-6 w-6"})}),(0,i.jsx)("h1",{className:"text-lg font-semibold",children:"맛 올리기"})]}),(0,i.jsxs)("form",{onSubmit:O,className:"flex flex-col gap-6 p-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"사진"}),(0,i.jsx)("input",{ref:t,type:"file",accept:"image/*",capture:"environment",onChange:U,className:"hidden"}),a?(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("img",{src:a,alt:"업로드 미리보기",className:"max-h-64 w-full rounded-xl object-cover"}),(0,i.jsx)("button",{type:"button",onClick:()=>g(null),className:"absolute right-2 top-2 rounded-full bg-black/50 px-2 py-1 text-sm text-white",children:"삭제"})]}):(0,i.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.click()},className:"flex min-h-[120px] w-full touch-target items-center justify-center rounded-xl border-2 border-dashed border-gray-300 bg-gray-50 text-gray-500 active:scale-[0.98]",children:"사진 선택 (카메라/갤러리)"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"메뉴 이름"}),(0,i.jsx)("input",{type:"text",value:c,onChange:e=>x(e.target.value),placeholder:"예: 뼈해장국",maxLength:50,className:"min-h-[44px] w-full rounded-xl border border-gray-200 px-4 py-2 text-base outline-none focus:border-primary focus:ring-2 focus:ring-primary/20"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"맛 리뷰 (100자)"}),(0,i.jsx)(b,{value:u,onChange:w})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"장소 (선택)"}),(0,i.jsx)("input",{type:"text",value:d,onChange:e=>k(e.target.value),placeholder:"예: 서울 합정, 부산 서면",maxLength:50,className:"min-h-[44px] w-full rounded-xl border border-gray-200 px-4 py-2 text-base outline-none focus:border-primary focus:ring-2 focus:ring-primary/20"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"mb-2 block text-sm font-medium text-gray-700",children:"평점"}),(0,i.jsx)("div",{className:"flex gap-3",children:y.map(e=>(0,i.jsxs)("button",{type:"button",onClick:()=>j(e.value),className:(0,v.cn)("touch-target flex flex-1 items-center justify-center gap-2 rounded-xl border-2 py-2 text-sm font-medium transition active:scale-95",h===e.value?"border-primary bg-primary/10 text-primary":"border-gray-200 bg-white text-gray-600"),children:[(0,i.jsx)("span",{children:e.emoji}),(0,i.jsx)("span",{children:e.label})]},e.value))})]}),(0,i.jsx)("button",{type:"submit",disabled:!a||!c.trim()||!u.trim()||f,className:"touch-target min-h-[48px] rounded-xl bg-primary font-medium text-white disabled:opacity-50 active:scale-95",children:f?"올리는 중…":"올리기"})]})]})}},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var a=r(1994),i=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.m6)((0,a.W)(t))}}},function(e){e.O(0,[590,648,971,117,744],function(){return e(e.s=8879)}),_N_E=e.O()}]);